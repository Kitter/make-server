#                                               ___            _        
#   ___ ___  _ __ ___  _ __ ___   ___  _ __    / / |_ __ _ ___| | _____ 
#  / __/ _ \| '_ ` _ \| '_ ` _ \ / _ \| '_ \  / /| __/ _` / __| |/ / __|
# | (_| (_) | | | | | | | | | | | (_) | | | |/ / | || (_| \__ \   <\__ \
#  \___\___/|_| |_| |_|_| |_| |_|\___/|_| |_/_/   \__\__,_|___/_|\_\___/
#
# make-config
- name: make-config | Disable seLinux
  when: config.selinux == False and ansible_os_family in [ 'RedHat', 'Debian' ]
  selinux: state=disabled

- name: make-config | Prepare swapfile
  when: config.useswap == True and ansible_memtotal_mb < 512
  register: swapfile
  shell: >
    dd if=/dev/zero of=/swapfile bs=1024 count=262144
    creates=/swapfile

- name: make-config | make swapfile
  when: swapfile.changed
  shell: mkswap /swapfile && swapon /swapfile

- name: make-config | {{ local.src }} directory should be created
  file: >
    path={{ local.src }}
    mode=0775
    owner=root
    group=wheel
    state=directory

- name: make-config | Deploy /etc/motd
  template: >
    src=etc/motd.j2
    dest=/etc/motd


